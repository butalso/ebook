## 缓存

### 什么是缓存
缓存一词最开始用于CPU和主内存之间，原始意义是指访问速度比一般随机存取存储器(RAM)快的一种RAM。现如今，凡是位于速度相差较大的两种硬件之间，用于协调两者数据传输差异的结构，均可称为缓存。比如在内存和硬盘之间的磁盘缓存，硬盘与网络之间Internet临时文件夹或网络内容缓存。在互联网行业，常常需要通过缓存数据库中的数据来实现应用的高性能和高并发。

### 缓存特征
* 命中率：`命中率=返回正确结果数/请求缓存次数`
* 最大空间：可支持缓存数据所占空间的最大值，一旦元素数量超过这个值，将会触发缓存淘汰策略。
* 淘汰策略：如FIFO、LRU、LFU等。

### 缓存分类（按缓存与应用的耦合度）
* 本地缓存(local cache)：指的是在应用中的缓存组件，其最大的优点是应用和cache是在同一个进程内部，请求缓存非常快速，没有过多的网络开销等，在单应用不需要集群支持或者集群情况下各节点无需互相通知的场景下使用本地缓存较合适；同时，它的缺点也是应为缓存跟应用程序耦合，多个应用程序无法直接的共享缓存，各应用或集群的各节点都需要维护自己的单独缓存，对内存是一种浪费,而且，不同节点间可能存在数据不一致问题，使用时需要考虑缓存数据的时效性。
* 分布式缓存(remote cache):指的是与应用分离的缓存组件或服务，其最大的优点是自身就是一个独立的应用，与本地应用隔离，多个应用可直接的共享缓存。缺点就是请求会有网络开销。

### 本地缓存
### 分布式缓存
### 缓存更新
### 


### 本地缓存 map
* 本地缓存非常高效，从分布式缓存取一次数据消耗的时间可以从本地缓存取几千几万甚至百万次
* 本地缓存在集群环境下存在不同节点数据不一致问题，因此，使用时需要考虑缓存的时效性，以及缓存数据对不一致的敏感程度

#### 缓存时效性
* 不同场景对同一份数据的时效性有差异，比如商品库存，在页面展示是否可以购买时可以有短暂的缓存，但是订单提交时必须是实时的数据
* 不同数据时效性不一样，比如商品属性时效性要求较低，商品价格和库存的时效性要求就比较高。

#### 本地缓存+分布式缓存构建高性能网站
* 使用本地缓存做一级缓存，减少分布式缓存的访问量（网络IO带宽消耗和IO传输时间）
* 使用分布式缓存做二级缓存，减少集群环境下访问数据库的次数